var url = "index.php";
var change_boxes = ["box-show-category-list" , "box-show-topic-list"];

$("#btn-show-cat-list").on('click', function(){
    var post = "control=cat&action=getcategories";
    ajaxCall(post, url, shownotification(''), showCategoriesSuccess, removenotification);
});
$("#btn-add-categories").on('click', function(){
    var post = "control=cat&action=addcategories&catname="+$('#txt-add-catname').val()+"&mokeyword="+$('#txt-add-mokeyword').val();
    ajaxCall(post, url, shownotification(''), AddCategoriesSuccess, removenotification);
});
$("#btn-show-topic-list").on('click', function(){
    var post = "control=topic&action=gettopic";
    ajaxCall(post, url, shownotification(''), showTopicSuccess, removenotification);
});
$("#btn-add-topic").on('click', function(){
    var post = "control=topic&action=addtopic&desc="+$('#txt-description-topic').val()+"&cat_id="+$('#lst-categories').val();
    ajaxCall(post, url, shownotification(''), addTopicSuccess, removenotification);
});
$('#lst-categories').change(function(){
    var post = "control=topic&action=gettopicbycat&cid="+$('#lst-categories').val();
    ajaxCall(post, url, shownotification(''), showTopicSuccess2, removenotification);
});
function showTopicSuccess2(data){
    $('#box-show-topic-list table').html('');
    data = JSON.parse(data);
    var table = [];
    table = data['table'];
    var myFormGenerator = new formGenerator();
    var search = myFormGenerator.generateTableData(table['cols'], table['schema'],table['labels'], table['ids'], table['control'],data['topic']);
    $('#box-show-topic-list table').append(search);
    toggleBoxes('box-show-topic-list',change_boxes);
}
function addTopicSuccess(data){
    console.log(data);
}
function showTopicSuccess(data){
    $('#box-show-topic-list table').html('');
    $('#lst-categories').html('');
    console.log(data);
    data = JSON.parse(data);
    var table = [];
    var cat = [];
    table = data['table'];
    var myFormGenerator = new formGenerator();
    var search = myFormGenerator.generateTableData(table['cols'], table['schema'],table['labels'], table['ids'], table['control'],data['topic']);
    $.each(data['category'], function(i,v){
        $('#lst-categories').append('<option value='+v['id']+'>'+ v['category_name'] + '</option>');
    });
    $('#box-show-topic-list table').append(search);
    toggleBoxes('box-show-topic-list',change_boxes);
}
function AddCategoriesSuccess(data){

}
function showCategoriesSuccess(data){
    $('#box-show-category-list table').html('');
    console.log(data);
    data = JSON.parse(data);
    var table = [];
    var cat = [];
    table = data['table'];
    var myFormGenerator = new formGenerator();
    var search = myFormGenerator.generateTableData(table['cols'], table['schema'],table['labels'], table['ids'], table['control'] ,data['data']);
    //console.log(search);
    //$('#box-show-category-list table').append(search);
    $('#box-show-category-list table').append(search);
    toggleBoxes('box-show-category-list',change_boxes);
}

function deleteItem(id,control){
    var action = 'delete'+control;
    if (confirm("Are you sure?")){
        var post = "control="+control+"&action="+action+"&id="+id;
        ajaxCall(post, url, shownotification(''), deleteItemSuccess, removenotification);
    }
    else{
        return false;
    }
}
function editItem(id,control){
    var action = edit+control;
    if (confirm("Are you sure?")){
        var post = "control="+control+"&action="+action+"&id="+id;
        ajaxCall(post, url, shownotification(''), deleteItemSuccess, removenotification);
    }
    else{
        return false;
    }
}

function deleteItemSuccess(data){

}